---
title: "Oumayma's Questions"
output: html_document
date: "2025-11-25"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## 2. Does time of day relate to acceptance?

Variables (Description): time (categorical: 5 levels — morning, afternoon, evening, late night, unknown); acceptance (binary)	

Data Type: Multi-level categorical on binary outcome	

Planned Method of Analysis: One-way ANOVA on mean acceptance rates by time of day	

Hypotheses (H₀ / Hₐ): 
  - H₀: Mean acceptance is the same across all times of day.
  - Hₐ: At least one time-of-day group has a different mean acceptance.

```{r}
library(dplyr)
# Load data 
data <- read.csv("in-vehicle-coupon-rec.csv")
head(data)
```

```{r}
# Fix time order: 7AM → 10AM → 2PM → 6PM → 10PM
data$time <- factor(data$time, levels = c("7AM", "10AM", "2PM", "6PM", "10PM"), ordered = TRUE)

# Run one-way ANOVA to test if mean acceptance differs by time of day
summary(aov(Y ~ time, data = d))

# Tukey HSD post-hoc test - shows exactly WHICH times differ from each other
TukeyHSD(aov(Y ~ time, data = d))
# Plot the Tukey results – visual confidence intervals of all pairwise differences
plot(TukeyHSD(aov(Y ~ time, data = d))) # Any interval that does NOT cross zero = statistically significant difference

# Calculate acceptance rate (%) and sample size for each time 
temp   <- table(d$time, d$Y)           # crosstab: rows = time, columns = 0/1
rates  <- prop.table(temp, margin = 1) # row percentages
rates  <- rates[, "1"]                 # keep only the "accepted" column
n_obs  <- margin.table(temp, margin = 1)

# Combine results into a nice data frame and display
data.frame(time = names(rates),
           acceptance_rate = round(rates, 3),
           n = as.vector(n_obs),
           row.names = NULL)
```
The one-way ANOVA revealed a highly significant association between time of day and coupon acceptance (F(4, 12679) = 44.37, p < 0.001). Tukey’s post-hoc comparisons showed that acceptance was highest at 2 PM (66.2%), which was significantly higher than at 7 AM, 6 PM, and 10 PM, and marginally higher than at 10 AM (p = 0.002). Acceptance at 10 AM and 6 PM was also significantly higher than at 7 AM and 10 PM, whereas 7 AM and 10 PM did not differ from each other. Overall, drivers were markedly more likely to accept coupons during midday and early-evening hours than in the early morning or late night.



## 4. Is acceptance different by coupon type?	

Variables (Description): coupon (categorical: 4 levels — bar, coffee house, <$20 restaurant, $20–$50 restaurant); acceptance (binary)

Data Type: Categorical predictor with four levels	One-way ANOVA on acceptance means by coupon category	

Hypotheses (H₀ / Hₐ): 
  - H₀: Mean acceptance is equal across all coupon types.
  - Hₐ: At least one coupon type has a different mean acceptance.

```{r}
# Make sure 'coupon' is treated as a categorical variable
data$coupon <- factor(data$coupon)

# One-way ANOVA to test if acceptance differs by coupon type
summary(aov(Y ~ coupon, data = d))

# Tukey HSD post-hoc test – shows exactly WHICH coupon types differ
TukeyHSD(aov(Y ~ coupon, data = d))

# Plot Tukey results – visual of all pairwise differences
plot(TukeyHSD(aov(Y ~ coupon, data = d))) # Intervals not crossing zero = significant difference at p < 0.05

# Calculate acceptance rate and sample size for each coupon type
temp_table   <- table(d$coupon, d$Y)                    # Crosstab: coupon vs accept/reject
accept_rate  <- prop.table(temp_table, margin = 1)[, "1"]   # Acceptance % per coupon
n_per_coupon <- margin.table(temp_table, margin = 1)        # Number of offers per type

# Create clean results table and sort from highest to lowest acceptance
result_coupon <- data.frame(
  Coupon_Type     = names(accept_rate),
  Acceptance_Rate = round(as.numeric(accept_rate), 3),
  N               = as.vector(n_per_coupon),
  row.names       = NULL
)

# Sort by acceptance rate (highest first)
result_coupon[order(-result_coupon$Acceptance_Rate), ]
```

The one-way ANOVA revealed a highly significant association between coupon type and acceptance rate (F(4, 12679) = 234.5, p < 2e-16). Tukey’s HSD post-hoc comparisons (95% family-wise confidence level) showed that acceptance rates for Carry out & Take away (71.6%) and Restaurant(<20) (70.7%) were virtually identical and not significantly different from each other (p = 0.208), but both were significantly higher than all other coupon types (p < 0.001). Coffee House coupons (49.9%) had moderate acceptance, significantly higher than both Restaurant(20-50) (44.1%) and Bar (41.0%) coupons (p < 0.001), whereas acceptance of Bar and Restaurant(20-50) did not differ significantly (p = 0.318). Overall, drivers were far more likely to accept low-cost, immediately usable food offers (carry-out and inexpensive restaurant coupons) than coffee-house, mid-range restaurant, or bar coupons. 
